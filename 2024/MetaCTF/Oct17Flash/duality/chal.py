from Crypto.Util.number import * 
from os import urandom

#Get Private Key
p = getPrime(256)
q = getPrime(512)
phi = p*(p-1)*q

d1 = getPrime(1023)
d2 = d1
while True:
    d2 = d1 + bytes_to_long(urandom(10))
    if isPrime(d2):
        break

#Get Public Key
e1 = inverse(d1,phi)
e2 = inverse(d2,phi)
N = p*p*q

#Encryption
flag = b'REDACTED'
half1= bytes_to_long(flag[:len(flag)//2])
half1= pow(half1,e1,N)
half2= bytes_to_long(flag[len(flag)//2:])
half2= pow(half2,e2,N)

print(f'{half1=}')
print(f'{half2=}')
print(f'{e1=}')
print(f'{e2=}')
print(f'{N=}')

############
'''
half1=78651793350576640257900270619795917529285047644781765616581951057657331607131680336334150941043270280956949519156262933098001212767520262811961846436456656232341708272687902930721771428435673461029160550713916008786765253837510226768726267021261591817547516595574853876261700889652868486451202805313650219035
half2=30521573044014797629905067010977428736108369836323048856638167547126098265619057810389376407142161783807725860136412967017301160328902290246130326937605121934755173596117979252594236685871178336014678635615730794208623869595900231140992001089801097773670072560758257753786495727148635061494576282052813437443
e1=48041843429846995439836089780466518990169717666500777185155099979742475823401831891726475465268908458890247473550715925911568215099863398806220424601608634294086687496014534365765293677751551370125683019404227658935319070779153770341163005699949953408333148903106238404181636497469874910954910839321212097377
e2=81321083568988906930621381366281884594209208525141702431451133589494246818051381307156037678664472921898900352239167226199151581081491752218518268840312768099135951875491714805539024406839288835828740432643135907728846419267437850846744605160826081609587285016495347365304540108695192262127687343324790311323
N=85331786094363726303676262519644108650742699682084288027986403245313360478382722639360576783920875212775769669608267562536548019296066688463786544707608059141596098797246525476204652518715852830744533620825938766057674429338584968831567070056099772240180671323983938508942001779310674405066276411305766485357
'''