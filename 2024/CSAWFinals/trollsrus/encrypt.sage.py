

# This file was *autogenerated* from the file encrypt.sage
from sage.all_cmdline import *   # import sage library

_sage_const_55 = Integer(55); _sage_const_7 = Integer(7); _sage_const_1048576 = Integer(1048576); _sage_const_5 = Integer(5); _sage_const_310887 = Integer(310887); _sage_const_216621 = Integer(216621); _sage_const_265484 = Integer(265484); _sage_const_174500 = Integer(174500); _sage_const_17777 = Integer(17777); _sage_const_120033 = Integer(120033); _sage_const_509794 = Integer(509794); _sage_const_472383 = Integer(472383); _sage_const_207899 = Integer(207899); _sage_const_137579 = Integer(137579); _sage_const_79499 = Integer(79499); _sage_const_124308 = Integer(124308); _sage_const_276940 = Integer(276940); _sage_const_128084 = Integer(128084); _sage_const_47635 = Integer(47635); _sage_const_98217 = Integer(98217); _sage_const_355596 = Integer(355596); _sage_const_162484 = Integer(162484); _sage_const_512568 = Integer(512568); _sage_const_115895 = Integer(115895); _sage_const_173988 = Integer(173988); _sage_const_275814 = Integer(275814); _sage_const_147875 = Integer(147875); _sage_const_300084 = Integer(300084); _sage_const_307229 = Integer(307229); _sage_const_211325 = Integer(211325); _sage_const_513412 = Integer(513412); _sage_const_353600 = Integer(353600); _sage_const_122876 = Integer(122876); _sage_const_294850 = Integer(294850); _sage_const_157799 = Integer(157799); _sage_const_22315 = Integer(22315); _sage_const_520548 = Integer(520548); _sage_const_82043 = Integer(82043); _sage_const_94241 = Integer(94241); _sage_const_280271 = Integer(280271); _sage_const_362973 = Integer(362973); _sage_const_322837 = Integer(322837); _sage_const_514352 = Integer(514352); _sage_const_334680 = Integer(334680); _sage_const_320170 = Integer(320170); _sage_const_345083 = Integer(345083); _sage_const_46507 = Integer(46507); _sage_const_339191 = Integer(339191); _sage_const_340263 = Integer(340263); _sage_const_395440 = Integer(395440); _sage_const_232497 = Integer(232497); _sage_const_298320 = Integer(298320); _sage_const_78618 = Integer(78618); _sage_const_27607 = Integer(27607); _sage_const_35665 = Integer(35665); _sage_const_233166 = Integer(233166); _sage_const_315029 = Integer(315029); _sage_const_153394 = Integer(153394); _sage_const_327546 = Integer(327546); _sage_const_9456 = Integer(9456); _sage_const_87785 = Integer(87785); _sage_const_54329 = Integer(54329); _sage_const_52914 = Integer(52914); _sage_const_192255 = Integer(192255); _sage_const_362113 = Integer(362113); _sage_const_192465 = Integer(192465); _sage_const_207086 = Integer(207086); _sage_const_299247 = Integer(299247); _sage_const_33383 = Integer(33383); _sage_const_323491 = Integer(323491); _sage_const_56227 = Integer(56227); _sage_const_256001 = Integer(256001); _sage_const_183181 = Integer(183181); _sage_const_347373 = Integer(347373); _sage_const_199740 = Integer(199740); _sage_const_142719 = Integer(142719); _sage_const_155115 = Integer(155115); _sage_const_234629 = Integer(234629); _sage_const_367075 = Integer(367075); _sage_const_83187 = Integer(83187); _sage_const_434294 = Integer(434294); _sage_const_30813 = Integer(30813); _sage_const_288694 = Integer(288694); _sage_const_487957 = Integer(487957); _sage_const_173236 = Integer(173236); _sage_const_426480 = Integer(426480); _sage_const_322954 = Integer(322954); _sage_const_316362 = Integer(316362); _sage_const_284385 = Integer(284385); _sage_const_33915 = Integer(33915); _sage_const_193405 = Integer(193405); _sage_const_378609 = Integer(378609); _sage_const_345142 = Integer(345142); _sage_const_62277 = Integer(62277); _sage_const_52961 = Integer(52961); _sage_const_370215 = Integer(370215); _sage_const_383304 = Integer(383304); _sage_const_179975 = Integer(179975); _sage_const_287570 = Integer(287570); _sage_const_254824 = Integer(254824); _sage_const_306056 = Integer(306056); _sage_const_33864 = Integer(33864); _sage_const_480414 = Integer(480414); _sage_const_41906 = Integer(41906); _sage_const_387104 = Integer(387104); _sage_const_504860 = Integer(504860); _sage_const_17263 = Integer(17263); _sage_const_15869 = Integer(15869); _sage_const_47583 = Integer(47583); _sage_const_128248 = Integer(128248); _sage_const_71449 = Integer(71449); _sage_const_225403 = Integer(225403); _sage_const_458480 = Integer(458480); _sage_const_514062 = Integer(514062); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2)
from random import randint

N = _sage_const_55 
p = _sage_const_7  
q = _sage_const_1048576 
d = _sage_const_5  
h = [_sage_const_310887 , _sage_const_216621 , -_sage_const_265484 , _sage_const_174500 , -_sage_const_17777 , -_sage_const_120033 , _sage_const_509794 , _sage_const_472383 , -_sage_const_207899 , _sage_const_137579 , -_sage_const_79499 , -_sage_const_124308 , -_sage_const_276940 , _sage_const_128084 , -_sage_const_47635 , -_sage_const_98217 , -_sage_const_355596 , _sage_const_162484 , _sage_const_512568 , _sage_const_115895 , _sage_const_173988 , -_sage_const_275814 , _sage_const_147875 , _sage_const_300084 , -_sage_const_307229 , _sage_const_211325 , -_sage_const_513412 , _sage_const_353600 , _sage_const_122876 , -_sage_const_294850 , -_sage_const_157799 , -_sage_const_22315 , _sage_const_520548 , -_sage_const_82043 , _sage_const_94241 , -_sage_const_280271 , -_sage_const_362973 , _sage_const_322837 , _sage_const_514352 , _sage_const_334680 , -_sage_const_320170 , _sage_const_345083 , _sage_const_46507 , -_sage_const_339191 , _sage_const_340263 , _sage_const_395440 , -_sage_const_232497 , _sage_const_298320 , _sage_const_78618 , -_sage_const_27607 , -_sage_const_35665 , -_sage_const_233166 , _sage_const_315029 , -_sage_const_153394 , -_sage_const_327546 ]
ciphertext_key = [_sage_const_9456 , -_sage_const_87785 , _sage_const_54329 , -_sage_const_52914 , _sage_const_192255 , -_sage_const_362113 , _sage_const_192465 , _sage_const_207086 , -_sage_const_299247 , _sage_const_33383 , _sage_const_323491 , -_sage_const_56227 , -_sage_const_256001 , _sage_const_183181 , _sage_const_347373 , _sage_const_199740 , -_sage_const_142719 , -_sage_const_155115 , -_sage_const_234629 , _sage_const_367075 , _sage_const_83187 , -_sage_const_434294 , _sage_const_30813 , -_sage_const_288694 , _sage_const_487957 , _sage_const_173236 , -_sage_const_426480 , _sage_const_322954 , -_sage_const_316362 , -_sage_const_284385 , _sage_const_33915 , -_sage_const_193405 , -_sage_const_378609 , -_sage_const_345142 , _sage_const_62277 , _sage_const_52961 , _sage_const_370215 , _sage_const_383304 , _sage_const_179975 , _sage_const_287570 , -_sage_const_254824 , _sage_const_306056 , _sage_const_33864 , -_sage_const_480414 , _sage_const_41906 , -_sage_const_387104 , -_sage_const_504860 , -_sage_const_17263 , _sage_const_15869 , _sage_const_47583 , _sage_const_128248 , -_sage_const_71449 , -_sage_const_225403 , -_sage_const_458480 , _sage_const_514062 ]

def Zx(l):
    return list(l)

def gen_poly(d):
    res = N*[_sage_const_0 ]
    for j in range(d):  
        r = randint(_sage_const_0 ,N-_sage_const_1 )
        while res[r] != _sage_const_0 :
            r = randint(_sage_const_0 ,N-_sage_const_1 )
        res[r] = randint(-_sage_const_1 ,_sage_const_1 )
    return Zx(res)
    
def gen_msg(d):
    return ZZ(list(randint(_sage_const_0 ,d-_sage_const_1 )-_sage_const_2  for j in range(N)))

def encrypt(m, h): 
    r = gen_poly(d)
    return rangedmod(polymult(public_key,p*r) + m,q)

def generate_keys():
    while True:
        try:
            f = gen_poly(d)
            g = gen_poly(d)
            f_p = finvmodp(f,p)  
            secret_key = f, f_p
            h = rangedmod(p * polymult(f_q,g),q)
            break
        except:
            print("bad f and/or g, try again")
    
    return h,secret_key

print(gen_poly(d))

